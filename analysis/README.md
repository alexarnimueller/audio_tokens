# Python tool to convert results

jsPsych has the option to save the experiment results in json (as shown above) or csv format. However the results from an Audio-Tokens trial contain ratings for multiple stimuli. To simplify further analysis, we provide a python command-line tool that converts the data coming from jsPsych to a spreadsheet in "long format".

This requires Python 3 to be installed along with the packages pandas, numpy and scipy.

In a terminal, navigate to the folder where you saved the `audio_tokens.py` file. You can call the script like this:

```
python audio_tokens.py --infile example_results.csv --outfile converted/example_results
```

where the first argument `--infile` specifies the path to the jsPsych result file, and `--outfile` specifies the path where the outputs of the script should be stored. Depending on the types of ratings that are present in the jsPsych results, different output files will be generated, as described further below.

If you saved the data in json format, you can call the script equivalently:

```
python audio_tokens.py --infile example_results.json --outfile converted/example_results
```

You can see the files that are generated by this command in [`converted/`](./converted/). In the following, we describe the results generated for the different rating interfaces:

## Single feature rating

<img src="../imgs/figure_one_feature.png" alt="drawing" width="300"/>

This is the json-formatted output from jsPsych:

```
[
	{
		"stimuli": [
			"data/speaker1.wav",
			"data/speaker2.wav",
			"data/speaker3.wav",
			"data/speaker4.wav"
		],
		"ratings": [
			0.3,
			0.22142857142857142,
			1,
			0.6071428571428571
		],
		"elapsed": [
			2.483076923076923,
			1.2666666666666666,
			1.1859259259259258,
			1.685840707964602
		],
		"rt": 6644,
		"ratingtype": "features",
		"labels": [
			"Feature 1"
		],
		"trial_type": "audio-tokens",
		"trial_index": 0,
		"time_elapsed": 11151,
		"internal_node_id": "0.0-0.0"
	}
]
```

And this is the long-format data after conversion:

|    | stimulus                              | rating               | label     | trial_index | ratingtype |
|----|---------------------------------------|----------------------|-----------|-------------|------------|
| 0  | data/speaker1.wav   | 0.3    | Feature 1 | 0           | features   |
| 1  | data/speaker2.wav | 0.22142857142857142   | Feature 1 | 0           | features   |
| 2  | data/speaker3.wav | 1.   | Feature 1 | 0           | features   |
| 3  | data/speaker4.wav    | 0.6071428571428571  | Feature 1 | 0           | features   |
